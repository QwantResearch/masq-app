(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,n){"use strict";var a=n(8),r=n(9),c=n(16),s=n(10),i=n(14),o=n(2),u=n(0),l=n.n(u),p=n(5);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var d=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("rect",{height:118,opacity:.5,rx:10,stroke:"#999",strokeWidth:2,width:118,x:1,y:1}),l.a.createElement("path",{d:"m77.2 46.6h-6.5333333l-3.1733334-4.8533333c-.3733333-.3733334-.9333333-.7466667-1.4933333-.7466667h-11.2c-.56 0-1.12.3733333-1.4933333.7466667l-3.1733334 4.8533333h-6.5333333c-3.1733333 0-5.6 2.4266667-5.6 5.6v20.5333333c0 3.1733334 2.4266667 5.6 5.6 5.6h33.6c3.1733333 0 5.6-2.4266666 5.6-5.6v-20.5333333c0-3.1733333-2.4266667-5.6-5.6-5.6zm1.8666667 26.1333333c0 1.12-.7466667 1.8666667-1.8666667 1.8666667h-33.6c-1.12 0-1.8666667-.7466667-1.8666667-1.8666667v-20.5333333c0-1.12.7466667-1.8666667 1.8666667-1.8666667h7.4666667c.56 0 1.12-.3733333 1.4933333-.7466666l3.1733333-4.8533334h9.1466667l3.1733333 4.8533334c.56.3733333 1.12.7466666 1.68.7466666h7.4666667c1.12 0 1.8666667.7466667 1.8666667 1.8666667zm-18.6666667-20.5333333c-5.2266667 0-9.3333333 4.1066667-9.3333333 9.3333333 0 5.2266667 4.1066666 9.3333334 9.3333333 9.3333334s9.3333333-4.1066667 9.3333333-9.3333334c0-5.2266666-4.1066666-9.3333333-9.3333333-9.3333333zm0 14.9333333c-3.1733333 0-5.6-2.4266666-5.6-5.6 0-3.1733333 2.4266667-5.6 5.6-5.6s5.6 2.4266667 5.6 5.6c0 3.1733334-2.4266667 5.6-5.6 5.6z",fill:"#ccc",fillRule:"nonzero"})),f=function(e){return l.a.createElement("svg",h({height:120,viewBox:"0 0 120 120",width:120},e),d)},m=(n.p,n(229),function(e){var t=e.size,n=e.image,a=e.onClick;return l.a.createElement(p.Avatar,{upload:!0,src:n,width:t,height:t,onClick:a})}),v=function(e){var t=e.style,n=e.onClick;return l.a.createElement(f,{className:"Avatar upload",color:"var(--grey-200)",style:t,onClick:n})},b=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(c.a)(this,Object(s.a)(t).call(this,e))).openDialog=n.openDialog.bind(Object(o.a)(Object(o.a)(n))),n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"openDialog",value:function(){this.refs.fileDialog.click()}},{key:"render",value:function(){var e=this.props,t=e.size,n=e.image,a=e.upload,r=e.onChange,c={backgroundImage:"url("+n+")"};return a?l.a.createElement("div",null,l.a.createElement("input",{name:"avatar",type:"file",ref:"fileDialog",style:{display:"none"},onChange:r,accept:".jpg, .jpeg, .png"}),n?l.a.createElement(m,{size:t,image:n,onClick:this.openDialog}):l.a.createElement(v,{style:c,onClick:this.openDialog})):l.a.createElement(p.Avatar,{src:n,width:t,height:t})}}]),t}(l.a.Component);b.defaultProps={size:120};var g=n(43),A=n.n(g);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var E=l.a.createElement("line",{x1:18,y1:6,x2:6,y2:18}),w=l.a.createElement("line",{x1:6,y1:6,x2:18,y2:18}),O=function(e){return l.a.createElement("svg",y({width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-x"},e),E,w)},k=(n.p,n(230),function(e){var t=e.onClose,n=e.width,a=e.height,r=e.children;return l.a.createElement("div",{className:"Modal"},l.a.createElement("div",{className:"overlay",onClick:t}),l.a.createElement("div",{className:"modal",style:{width:n,height:a}},t&&l.a.createElement(O,{className:"close",width:16,height:16,onClick:t}),r))}),j=function(e){var t=e.onClose,n=e.width,a=e.height,r=e.children;return l.a.createElement("div",null,l.a.createElement(A.a,{maxWidth:800},l.a.createElement(k,{width:"100%",onClose:t,height:a,children:r})),l.a.createElement(A.a,{minWidth:801},l.a.createElement(k,{width:n,onClose:t,height:a,children:r})))},C=n(124),x=n(15),S=n(12),N=n(119),_=n.n(N),D=Object(x.b)(null,function(e){return{setNotification:function(t){return e(Object(S.g)(t))}}})(function(e){var t=e.setNotification,n=Object(C.a)(e,["setNotification"]);return setTimeout(function(){return t(null)},5e3),l.a.createElement("div",{className:_.a.Notification},l.a.createElement(p.Notification,Object.assign({},n,{onClose:function(){return t(null)}})))});n.d(t,"a",function(){return b}),n.d(t,"b",function(){return j}),n.d(t,"c",function(){return D})},115:function(e,t,n){"use strict";(function(e){var a=n(123),r=n(1),c=n.n(r),s=n(4),i=n(8),o=n(9),u=n(16),l=n(10),p=n(14),h=n(2),d=n(0),f=n.n(d),m=n(15),v=n(35),b=n(125),g=n(241),A=n(45),y=n(36),E=n(11),w=n(12),O=n(30),k=Object(v.a)(),j=[{path:"/apps",sidebar:y.e,main:y.a},{path:"/devices",sidebar:y.e,main:y.b},{path:"/settings",sidebar:y.e,main:y.d}];var C=function(t){function r(){var e;return Object(i.a)(this,r),(e=Object(u.a)(this,Object(l.a)(r).call(this))).dbMasqPrivate=null,e.dbMasqPublic=null,e.dbs={},e.sw=null,e.state={messages:[],hash:null,prevPath:""},e.processLink=e.processLink.bind(Object(h.a)(Object(h.a)(e))),e}return Object(p.a)(r,t),Object(o.a)(r,[{key:"componentDidMount",value:function(){var e=Object(s.a)(c.a.mark(function e(){var t,a,r,s=this;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Masq version: ".concat("c693be1")),this.props.devices.length||(t=n(237).detect(),a=t.name,r=t.os,this.props.addDevice({name:"".concat((c=a,c.charAt(0).toUpperCase()+c.slice(1))," sur ").concat(r),description:"Cet appareil",color:"#40ae6c"})),k.listen(function(e){e.pathname!==s.state.prevPath&&s.setState({prevPath:k.location.pathname})});case 3:case"end":return e.stop()}var c},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"processLink",value:function(){var t=this.props,n=t.setCurrentAppRequest,r=t.currentUser,c=window.location.hash.substr(7);if(c.length){var s=e.from(c,"base64");try{var i=JSON.parse(s),o=Object(a.a)(i,4),u=o[0];o[1];n({appId:u,channel:o[2],key:o[3],link:window.location.href})}catch(l){console.error(l)}return r?f.a.createElement(b.a,{to:this.state.prevPath}):f.a.createElement(b.a,{to:"/"})}}},{key:"render",value:function(){var e=this.props,t=e.currentUser,n=e.currentAppRequest,a=e.notification,r=e.setCurrentAppRequest;return f.a.createElement(g.a,{history:k},f.a.createElement("div",null,a&&f.a.createElement(E.c,a),t&&n&&f.a.createElement(O.b,{onClose:function(){return r(null)},appRequest:n}),f.a.createElement(A.a,{exact:!0,path:"/link/:hash",component:this.processLink}),f.a.createElement(A.a,{exact:!0,path:"/",component:y.c}),f.a.createElement("div",{style:{display:"flex"}},j.map(function(e,t){return f.a.createElement(A.a,{key:t,path:e.path,component:e.sidebar})}),j.map(function(e,t){return f.a.createElement(A.a,{key:t,path:e.path,component:e.main})}))))}}]),r}(d.Component);t.a=Object(m.b)(function(e){return{currentAppRequest:e.masq.currentAppRequest,currentUser:e.masq.currentUser,devices:e.masq.devices,users:e.masq.users,notification:e.notification.currentNotification}},function(e){return{addDevice:function(t){return e(Object(w.a)(t))},setCurrentAppRequest:function(t){return e(Object(w.f)(t))}}})(C)}).call(this,n(6).Buffer)},119:function(e,t,n){e.exports={Notification:"Notification_Notification__33bRn"}},12:function(e,t,n){"use strict";var a=n(19),r=n(78);n.d(t,"h",function(){return s}),n.d(t,"i",function(){return i}),n.d(t,"j",function(){return o}),n.d(t,"l",function(){return u}),n.d(t,"k",function(){return l}),n.d(t,"c",function(){return p}),n.d(t,"a",function(){return h}),n.d(t,"b",function(){return d}),n.d(t,"f",function(){return f}),n.d(t,"d",function(){return v}),n.d(t,"e",function(){return b}),n.d(t,"g",function(){return g});var c=new r.a,s=function(e){return{type:"SET_SYNC_STEP",syncStep:e}},i=function(e,t){return function(n){return c.openProfile(e.id,t).then(function(e){return n({type:"SIGNIN",profile:e})})}},o=function(){return function(e){return c.closeProfile().then(function(){return e({type:"SIGNOUT"})})}},u=function(e,t){var n=Object(a.a)({},t,{id:e});return function(e){return c.updateProfile(n).then(function(){return e({type:"SIGNIN",profile:n})})}},l=function(e){var t=e.password;return function(n){return c.addProfile(e).then(function(e){return n(i(e,t))})}},p=function(){return function(e){return c.getProfiles().then(function(t){return e(function(e){return{type:"RECEIVE_USERS",users:e}}(t))})}},h=function(e){return{type:"ADD_DEVICE",device:e}},d=function(){return function(e){return c.getApps().then(function(t){return e(function(e){return{type:"RECEIVE_APPS",apps:e}}(t))})}},f=function(e){return{type:"SET_CURRENT_APP_REQUEST",app:e}},m=function(e){return{type:"UPDATE_CURRENT_APP_REQUEST",update:e}},v=function(e,t,n){return function(a){return c.handleUserAppLogin(e,t,n).then(function(e){return a(m({isConnected:e}))})}},b=function(e){return function(t){return c.handleUserAppRegister(e).then(function(){return t(m({isConnected:e}))})}},g=function(e){return{type:"SET_NOTIFICATION",notification:e}}},120:function(e,t){e.exports="data:image/png;base64,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"},122:function(e,t,n){e.exports={AddProfile:"AddProfile_AddProfile__1JA_r"}},126:function(e,t,n){e.exports=n(240)},140:function(e,t){},142:function(e,t){},165:function(e,t){},186:function(e,t){},21:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return r});var a=n(118),r=1e5,c=function(e,t){var n=Object.keys(window.localStorage);return!!n&&n.map(function(e){return JSON.parse(window.localStorage.getItem(e))}).find(function(n){return(!t||n.id!==t)&&n.username===e})},s=function(e){return new Promise(function(t,n){new a.a(e,{quality:.8,width:512,height:512,convertSize:0,success:function(e){t(e)},error:function(e){n(e.message)}})})}},22:function(e,t,n){e.exports={Login:"Login_Login__Qynu5",title:"Login_title__1BzJq",Logo:"Login_Logo__1IASN",users:"Login_users__1e0_A",PlusSquare:"Login_PlusSquare__18XVq",user:"Login_user__1JIOl",passwordSection:"Login_passwordSection__20HgB",goback:"Login_goback__Ts1Dc",Background:"Login_Background__2i8U8"}},229:function(e,t,n){},23:function(e,t,n){e.exports={Sidebar:"SidebarMin_Sidebar__3LeA5",header:"SidebarMin_header__2pvrx",nav:"SidebarMin_nav__22aEQ",navElement:"SidebarMin_navElement__3m79a",active:"SidebarMin_active__2gOBa"}},230:function(e,t,n){},238:function(e,t,n){},24:function(e,t,n){e.exports={Sidebar:"SidebarMax_Sidebar__37HAs",header:"SidebarMax_header__wVHDi",nav:"SidebarMax_nav__3gnd0",navElement:"SidebarMax_navElement__1o1A2",active:"SidebarMax_active__l5wNF",logout:"SidebarMax_logout__2hUjx"}},240:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(112),s=n(34),i=n(113),o=n(15);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var u=n(52),l=n(19),p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{syncStep:0,users:[],apps:[],devices:[],currentUser:null,currentAppRequest:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGNIN":return Object(l.a)({},e,{currentUser:t.profile});case"SIGNOUT":return Object(l.a)({},e,{currentUser:null});case"RECEIVE_USERS":return Object(l.a)({},e,{users:t.users});case"RECEIVE_APPS":return Object(l.a)({},e,{apps:t.apps});case"SET_CURRENT_APP_REQUEST":return Object(l.a)({},e,{currentAppRequest:t.app});case"UPDATE_CURRENT_APP_REQUEST":return Object(l.a)({},e,{currentAppRequest:Object(l.a)({},e.currentAppRequest,t.update)});case"ADD_APP":return Object(l.a)({},e,{apps:[].concat(Object(u.a)(e.apps),[t.app])});case"ADD_DEVICE":return Object(l.a)({},e,{devices:[].concat(Object(u.a)(e.devices),[t.device])});case"SET_SYNC_STEP":return Object(l.a)({},e,{syncStep:t.syncStep});default:return e}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentNotification:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return Object(l.a)({},e,{currentNotification:t.notification});default:return e}},d=Object(s.c)({masq:p,notification:h}),f=n(115),m=(n(238),n(239),window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d),v=Object(s.e)(d,m(Object(s.a)(i.a)));Object(c.render)(r.a.createElement(o.a,{store:v},r.a.createElement(f.a,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},25:function(e,t,n){e.exports={Signup:"Signup_Signup__35pSB",title:"Signup_title__2cSqr",user:"Signup_user__cPdbJ",buttons:"Signup_buttons__1ZBD4",TextField:"Signup_TextField__1V6gN"}},28:function(e,t,n){e.exports={SyncDevice:"SyncDevice_SyncDevice__2OuS0",title:"SyncDevice_title__15E3r",description:"SyncDevice_description__n8JIp",loader:"SyncDevice_loader__UAgrQ"}},30:function(e,t,n){"use strict";var a=n(1),r=n.n(a),c=n(4),s=n(40),i=n(8),o=n(9),u=n(16),l=n(10),p=n(14),h=n(2),d=n(0),f=n.n(d),m=n(5),v=n(15),b=n(12),g=n(11),A=n(31),y=n(21),E=n(120),w=n.n(E),O=n(25),k=n.n(O),j=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={image:w.a,lastname:"",firstname:"",username:"",password:"",passwordConfirmation:""},n.currentStep=0,n.validationEnabled=!1,n.refAvatar=f.a.createRef(),n.next=n.next.bind(Object(h.a)(Object(h.a)(n))),n.finish=n.finish.bind(Object(h.a)(Object(h.a)(n))),n.isValid=n.isValid.bind(Object(h.a)(Object(h.a)(n))),n.previous=n.previous.bind(Object(h.a)(Object(h.a)(n))),n.openDialog=n.openDialog.bind(Object(h.a)(Object(h.a)(n))),n.handleKeyUp=n.handleKeyUp.bind(Object(h.a)(Object(h.a)(n))),n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"isValid",value:function(e){var t=this.state[e];if(!this.validationEnabled)return!0;switch(e){case"image":return!0;case"firstname":case"lastname":return Object(A.a)(t);case"username":return Object(A.c)(t)&&!Object(y.c)(t);case"password":return Object(A.b)(t);case"passwordConfirmation":return t===this.state.password;default:return!1}}},{key:"getUsernameLabel",value:function(){var e=this.state.username;return this.isValid("username")?arguments.length<=0?void 0:arguments[0]:Object(y.c)(e)?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]}},{key:"onChange",value:function(e,t){var n=t.target.value.trim();this.setState(Object(s.a)({},e,n))}},{key:"onImageChange",value:function(){var e=Object(c.a)(r.a.mark(function e(t){var n,a,c,s,i=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props.setNotification,a=new window.FileReader,c=t.target.files[0]){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Object(y.b)(c);case 7:if(!((s=e.sent).size>y.a)){e.next=11;break}return n({title:"L'image s\xe9lectionn\xe9e est trop lourde. Veuillez en choisir une autre.",error:!0}),e.abrupt("return");case 11:a.addEventListener("load",function(){i.setState({image:a.result})}),a.readAsDataURL(s);case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"openDialog",value:function(){this.refAvatar.current.openDialog()}},{key:"next",value:function(){var e=this;if(this.validationEnabled=!0,!["lastname","firstname","username"].every(function(t){return e.isValid(t)}))return this.forceUpdate();this.validationEnabled=!1,this.currentStep++,this.forceUpdate()}},{key:"previous",value:function(){this.currentStep--,this.forceUpdate()}},{key:"finish",value:function(){var e=this.props.onSignup;if(this.validationEnabled=!0,!this.isValid("password")||!this.isValid("passwordConfirmation"))return this.forceUpdate();e(this.state)}},{key:"handleKeyUp",value:function(e){"Enter"===e.key&&(0===this.currentStep?this.next():this.finish())}},{key:"render",value:function(){var e=this;return f.a.createElement(g.b,{onClose:this.props.onClose,height:650,width:511},f.a.createElement("div",{className:k.a.Signup},f.a.createElement("span",{className:k.a.title},"Ajouter un nouvel utilisateur"),0===this.currentStep&&f.a.createElement(f.a.Fragment,null,f.a.createElement(g.a,{size:120,upload:!0,ref:this.refAvatar,onChange:function(t){return e.onImageChange(t)},image:this.state.image||null}),f.a.createElement("div",{style:{paddingTop:24}}),f.a.createElement(m.Button,{secondary:!0,label:"Importer une photo",onClick:this.openDialog}),f.a.createElement("div",{style:{paddingBottom:32}}),f.a.createElement(m.TextField,{className:k.a.TextField,defaultValue:this.state.lastname,label:this.isValid("lastname")?"Nom":"Le nom ne peut \xeatre vide, et ne peut contenir que des caract\xe8res alphanum\xe9riques et des espaces.",error:!this.isValid("lastname"),onChange:function(t){return e.onChange("lastname",t)}}),f.a.createElement(m.TextField,{className:k.a.TextField,defaultValue:this.state.firstname,label:this.isValid("firstname")?"Pr\xe9nom":"Le pr\xe9nom ne peut \xeatre vide, et ne peut contenir que des caract\xe8res alphanum\xe9riques et des espaces.",error:!this.isValid("firstname"),onChange:function(t){return e.onChange("firstname",t)}}),f.a.createElement(m.TextField,{className:k.a.TextField,defaultValue:this.state.username,error:!this.isValid("username"),onChange:function(t){return e.onChange("username",t)},onKeyUp:this.handleKeyUp,label:this.getUsernameLabel("Pseudo (affich\xe9)","Pseudo d\xe9j\xe0 utilis\xe9. Veuillez en choisir un autre.","Le pseudo ne doit pas contenir d'espaces, et peut contenir les caract\xe8res sp\xe9ciaux suivants: !?$#@()-*")}),f.a.createElement("div",{className:k.a.buttons},f.a.createElement(m.Button,{label:"Suivant",onClick:this.next,width:185}))),1===this.currentStep&&f.a.createElement(f.a.Fragment,null,f.a.createElement(g.a,{size:120,image:this.state.image,firstname:this.state.firstname,lastname:this.state.lastname}),f.a.createElement("p",{className:k.a.user},this.state.username),f.a.createElement(m.TextField,{className:k.a.TextField,autoFocus:!0,type:"password",label:this.isValid("password")?"Mot de passe":"Le mot de passe doit \xeatre compos\xe9 d'au moins 8 caract\xe8res, et contenir au moins un chiffre et un caract\xe8re sp\xe9cial (!?$#@()-*)",error:!this.isValid("password"),onChange:function(t){return e.onChange("password",t)}}),f.a.createElement(m.TextField,{className:k.a.TextField,type:"password",label:this.isValid("passwordConfirmation")?"Mot de passe (confirmation)":"Les mots de passe ne correspondent pas.",error:!this.isValid("passwordConfirmation"),onKeyUp:this.handleKeyUp,onChange:function(t){return e.onChange("passwordConfirmation",t)}}),f.a.createElement("div",{className:k.a.buttons},f.a.createElement(m.Button,{label:"Pr\xe9c\xe9dent",onClick:this.previous,width:185}),f.a.createElement(m.Button,{label:"Terminer",onClick:this.finish,width:185})))))}}]),t}(f.a.Component),C=Object(v.b)(null,function(e){return{setNotification:function(t){return e(Object(b.g)(t))}}})(j),x=n(32),S=n.n(x),N=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).state={loading:!0},n.handleOk=n.handleOk.bind(Object(h.a)(Object(h.a)(n))),n.handleRefuse=n.handleRefuse.bind(Object(h.a)(Object(h.a)(n))),n.handleAccept=n.handleAccept.bind(Object(h.a)(Object(h.a)(n))),n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=Object(c.a)(r.a.mark(function e(){var t,n,a,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!1}),t=this.props.appRequest,n=t.channel,a=t.key,c=t.appId,e.next=4,this.props.handleUserAppLogin(n,a,c);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(c.a)(r.a.mark(function e(t){var n,a,c,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.appRequest.channel!==this.props.appRequest.channel){e.next=2;break}return e.abrupt("return");case 2:return n=this.props.appRequest,a=n.channel,c=n.key,s=n.appId,e.next=5,this.props.handleUserAppLogin(a,c,s);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleRefuse",value:function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.handleUserAppRegister(!1);case 2:return e.next=4,this.props.setCurrentAppRequest(null);case 4:this.props.onClose();case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleAccept",value:function(){var e=Object(c.a)(r.a.mark(function e(){var t=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({loading:!0},Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.props.handleUserAppRegister(!0);case 2:return t.setState({loading:!1}),e.next=5,t.props.fetchApps();case 5:case"end":return e.stop()}},e)})));case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleOk",value:function(){var e=Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.setCurrentAppRequest(null);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"renderButtons",value:function(){var e=this.state.loading,t=this.props.appRequest;return e?f.a.createElement(m.Loader,null):!1===t.isConnected?f.a.createElement(d.Fragment,null,f.a.createElement(m.Button,{label:"Refuser",onClick:this.handleRefuse,color:"#e53b5b"}),f.a.createElement(m.Button,{label:"Valider",onClick:this.handleAccept,color:"#40ae6c"})):t.isConnected?f.a.createElement(m.Button,{label:"OK",onClick:this.handleOk,color:"#40ae6c"}):void 0}},{key:"renderText",value:function(){return!1===this.props.appRequest.isConnected?f.a.createElement("div",null,f.a.createElement("p",{className:S.a.description},"Cette notification apparait car cette application demande un acc\xe8s \xe0 votre stockage Masq."),f.a.createElement("p",{className:S.a.description},"Si vous n\u2019\xeates pas \xe0 l\u2019origine de cette demande, veuillez refuser cette requ\xeate.")):f.a.createElement("div",null,f.a.createElement("p",{className:S.a.description},"Vous avez autoris\xe9 l'application \xe0 acc\xe9der \xe0 votre stockage Masq."),f.a.createElement("p",{className:S.a.description},"Vous pouvez d\xe9sormais utiliser l'application."))}},{key:"render",value:function(){var e=this.props.appRequest;return f.a.createElement(g.b,{width:511,height:400},f.a.createElement("div",{className:S.a.AuthApp},f.a.createElement("p",{className:S.a.title},"Nouvelle requ\xeate de connexion de:"),f.a.createElement("p",{className:S.a.appTitle},e.appId),this.renderText(),f.a.createElement("div",{className:S.a.buttons},this.renderButtons())))}}]),t}(f.a.Component),_=Object(v.b)(function(e){return{currentUser:e.masq.currentUser}},function(e){return{handleUserAppLogin:function(t,n,a){return e(Object(b.d)(t,n,a))},handleUserAppRegister:function(t){return e(Object(b.e)(t))},setCurrentAppRequest:function(t){return e(Object(b.f)(t))},fetchApps:function(){return e(Object(b.b)())}}})(N),D=n(121),R=n.n(D),P=n(62),L=n.n(P),M=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(o.a)(t,[{key:"copyLink",value:function(){document.querySelector("input").select(),document.execCommand("copy")}},{key:"render",value:function(){var e=this.props,t=e.onClose,n=e.currentAppRequest;return f.a.createElement(g.b,{height:540,width:511,onClose:t},f.a.createElement("div",{className:L.a.QRCode},f.a.createElement("p",{className:L.a.title},"Connexion avec un autre appareil"),f.a.createElement("p",{className:L.a.description},"Scannez le QRCode suivant sur votre t\xe9l\xe9phone, ou copiez le lien suivant sur un autre appareil pour vous connecter depuis celui-ci."),f.a.createElement(R.a,{value:n.link,style:{marginBottom:16}}),f.a.createElement("input",{id:"link",readOnly:!0,defaultValue:n.link}),f.a.createElement(m.Button,{label:"Copier",onClick:this.copyLink})))}}]),t}(d.Component),I=Object(v.b)(function(e){return{currentAppRequest:e.masq.currentAppRequest}})(M);function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var U=f.a.createElement("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),z=f.a.createElement("polyline",{points:"22 4 12 14.01 9 11.01"}),V=function(e){return f.a.createElement("svg",B({width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-check-circle"},e),U,z)},T=(n.p,n(28)),q=n.n(T),F=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleOnClose=n.handleOnClose.bind(Object(h.a)(Object(h.a)(n))),n}return Object(p.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=setInterval(function(){e.props.setSyncStep(e.props.syncStep+1),2===e.props.syncStep&&clearInterval(t)},3e3)}},{key:"copyLink",value:function(){document.querySelector("input").select(),document.execCommand("copy")}},{key:"handleOnClose",value:function(){this.props.setSyncStep(0),this.props.onClose()}},{key:"renderSyncLink",value:function(){return f.a.createElement(g.b,{height:370,width:511,onClose:this.handleOnClose},f.a.createElement("div",{className:q.a.SyncDevice},f.a.createElement("p",{className:q.a.title},"Ajouter un appareil"),f.a.createElement("p",{className:q.a.description},"Copiez-collez le lien suivant pour synchroniser votre profil et vos applications avec un autre appareil."),f.a.createElement("input",{id:"link",readOnly:!0,defaultValue:"qwa.nt/0BJ8ZX"}),f.a.createElement(m.Button,{label:"Copier",onClick:this.copyLink})))}},{key:"renderSyncLoading",value:function(){return f.a.createElement(g.b,{height:370,width:511,onClose:this.handleOnClose},f.a.createElement("div",{className:q.a.SyncDevice},f.a.createElement("p",{className:q.a.title},"Ajouter un appareil"),f.a.createElement("p",{className:q.a.description},"Synchronisation en cours, veuillez patienter..."),f.a.createElement("div",{className:q.a.loader},f.a.createElement(m.Loader,null))))}},{key:"renderSyncComplete",value:function(){return f.a.createElement(g.b,{height:370,width:511,onClose:this.handleOnClose},f.a.createElement("div",{className:q.a.SyncDevice},f.a.createElement(V,{width:160,height:160,color:"#40ae6c"}),f.a.createElement("p",{className:q.a.description},"Synchronisation termin\xe9e. Vous pouvez maintenant vous connecter"),f.a.createElement(m.Button,{label:"OK",onClick:this.handleOnClose})))}},{key:"render",value:function(){var e=this.props.syncStep;return f.a.createElement("div",null,0===e&&this.renderSyncLink(),1===e&&this.renderSyncLoading(),2===e&&this.renderSyncComplete())}}]),t}(f.a.Component),K=Object(v.b)(function(e){return{syncStep:e.masq.syncStep}},function(e){return{setSyncStep:function(t){return e(Object(b.h)(t))}}})(F),Y=n(122),G=n.n(Y),Q=function(e){var t=e.onClose,n=e.onNewProfile;e.onSyncProfile;return f.a.createElement(g.b,{height:370,width:511,onClose:t},f.a.createElement("div",{className:G.a.AddProfile},f.a.createElement(m.Button,{label:"Nouveau profil",onClick:n}),f.a.createElement(m.Button,{secondary:!0,label:"Synchroniser un profil existant (bient\xf4t)"})))};n(74);n.d(t,"d",function(){return C}),n.d(t,"b",function(){return _}),n.d(t,"c",function(){return I}),n.d(t,"e",function(){return K}),n.d(t,"a",function(){return Q})},31:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return c});var a=function(e){return/^[A-z\xc0-\xfa\- ]+$/.test(e)},r=function(e){return/^[\w!?$#@()\-*]+$/.test(e)},c=function(e){return/^(?=.*\d)(?=.*[!?$#@()\-*]).{8,}$/.test(e)}},32:function(e,t,n){e.exports={AuthApp:"AuthApp_AuthApp__2U1N8",title:"AuthApp_title__1pDf1",appTitle:"AuthApp_appTitle__1lopr",description:"AuthApp_description__3EJl0",buttons:"AuthApp_buttons__1L9cS"}},36:function(e,t,n){"use strict";var a=n(1),r=n.n(a),c=n(4),s=n(8),i=n(9),o=n(16),u=n(10),l=n(14),p=n(2),h=n(0),d=n.n(h),f=n(15),m=n(12),v=n(5),b=n(22),g=n.n(b);function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var y=d.a.createElement("g",{fill:"#FFF",fillRule:"nonzero"},d.a.createElement("g",{fillOpacity:.5},d.a.createElement("path",{d:"M78.899 29.426l-.056-.487c0-.046-.045-.08-.09-.08h-.023c-.01 0-.01.012-.022.012a1.103 1.103 0 0 1-.393.068c-.158 0-.27-.046-.338-.125-.067-.09-.1-.227-.1-.43v-1.066h.808a.077.077 0 0 0 .079-.08v-.476c0-.045-.045-.08-.09-.08h-.809V25.993c0-.046-.045-.08-.09-.08h-.607c-.045 0-.078.034-.09.08v.69h-.472a.089.089 0 0 0-.09.092v.476c0 .045.034.079.068.09h.483v1.202c0 .374.09.657.259.839.168.181.438.272.786.272.146 0 .292-.012.427-.046.101-.022.203-.056.27-.09.067-.023.09-.046.09-.091 0 .011 0 .011 0 0zM65.155 28.769c-.01-.023-.022-.046-.033-.068-.012-.057.033-.114.067-.16.034-.045.056-.101.09-.158.056-.102.101-.215.135-.329.078-.238.1-.487.1-.736a2.605 2.605 0 0 0-.145-.782 1.98 1.98 0 0 0-.382-.624 2.048 2.048 0 0 0-.506-.43 1.98 1.98 0 0 0-.663-.261c-.247-.057-.506-.068-.753-.057-.258.023-.506.08-.742.193-.236.102-.449.249-.629.43a2.44 2.44 0 0 0-.45.624c-.112.238-.18.487-.202.748-.022.26-.01.521.045.77.057.25.158.488.293.704.134.215.303.396.494.544.191.147.416.26.64.34.124.045.259.068.394.09.123.023.247.034.37.023.124 0 .237-.011.36-.034.068-.011.135-.023.191-.034.056-.011.113-.023.135-.08.023-.045-.011-.09-.034-.135-.022-.057-.056-.102-.078-.16-.045-.101-.101-.192-.146-.294a.115.115 0 0 0-.068-.056c-.022-.012-.056 0-.078 0-.034.01-.068.01-.102.01-.134.024-.27.024-.404 0a1.466 1.466 0 0 1-.697-.294 1.557 1.557 0 0 1-.46-.59 1.563 1.563 0 0 1-.113-.747c.034-.25.124-.5.27-.703a1.5 1.5 0 0 1 .562-.465 1.441 1.441 0 0 1 1.404.09c.18.114.326.273.45.454a1.528 1.528 0 0 1 .112 1.383 1.57 1.57 0 0 1-.37.521c-.023.023-.046.035-.057.069a.098.098 0 0 0 0 .079l.416.839c.022.045.045.102.09.136.034.022.067.011.101.011h.64c.08 0 .135-.08.09-.159-.044-.079-.078-.158-.123-.226l-.214-.476zM68.931 28.644l.506-1.916a.085.085 0 0 1 .079-.056h.618c.045 0 .09.034.09.09v.023l-.9 2.709c-.01.034-.044.045-.078.045h-.585a.085.085 0 0 1-.078-.056l-.63-1.848-.606 1.848a.094.094 0 0 1-.079.045h-.573a.085.085 0 0 1-.079-.057l-.899-2.731c0-.046.034-.091.09-.091h.64c.034 0 .057.023.068.045l.506 1.927.584-1.915a.085.085 0 0 1 .079-.057h.528c.034 0 .067.023.079.045l.64 1.95zM72.471 27.034a.93.93 0 0 0-.382-.34 1.17 1.17 0 0 0-.528-.124c-.259 0-.495.068-.708.215-.214.136-.371.329-.483.555a1.724 1.724 0 0 0-.169.771v.057c.011.272.067.521.169.737.112.226.27.408.472.532.202.125.427.182.674.182.18 0 .337-.023.472-.08 0 0 .303-.102.472-.374l.011.295c.011.045.045.08.09.08h.573c.045 0 .09-.035.09-.091V26.75a.089.089 0 0 0-.09-.09h-.573a.098.098 0 0 0-.09.067v.306zm-.169.499c.135.147.191.34.191.578 0 .25-.067.442-.213.6a.694.694 0 0 1-.54.228.7.7 0 0 1-.539-.227.844.844 0 0 1-.213-.533s-.045-.374.213-.657c.135-.159.326-.227.55-.227-.01-.023.327-.045.551.238zM74.483 26.74c-.012-.046-.045-.08-.09-.08h-.585a.089.089 0 0 0-.09.09v2.699c0 .045.034.09.09.09h.607a.085.085 0 0 0 .079-.056v-1.485c0-.227.056-.408.157-.533a.535.535 0 0 1 .438-.193c.337 0 .506.227.506.67v1.54a.085.085 0 0 0 .079.057h.607c.044 0 .09-.034.09-.09v-1.655c0-.397-.09-.703-.27-.907-.18-.204-.439-.317-.776-.317-.202 0-.37.034-.517.113a.973.973 0 0 0-.348.329l.023-.272z"})),d.a.createElement("path",{d:"M21.497 8.887C20.587 7.833 19.25 7.3 17.52 7.3c-1.011 0-1.944.238-2.787.725-.854.476-1.472 1.122-1.876 1.905-.854-1.757-2.349-2.63-4.462-2.63-1.01 0-1.899.193-2.652.578a4.317 4.317 0 0 0-1.786 1.7l-.023-1.235a.574.574 0 0 0-.55-.578H.663a.578.578 0 0 0-.573.578v13.534c0 .317.258.578.573.578h2.82c.315 0 .574-.26.574-.578v-7.368c0-1.134.258-2.029.753-2.686.505-.658 1.202-.987 2.101-.987.9 0 1.55.284 1.955.84.405.555.618 1.427.618 2.595v7.594c0 .318.259.579.574.579h2.831c.315 0 .562-.25.574-.556v-7.356c0-1.157.247-2.063.753-2.71.505-.657 1.202-.986 2.078-.986.877 0 1.529.284 1.945.84.415.555.629 1.427.629 2.595v7.628c.022.307.27.545.573.545h2.832c.314 0 .573-.261.573-.579v-8.342c.022-2.03-.438-3.582-1.349-4.636zM39.938 7.753H37.23a.566.566 0 0 0-.55.578l-.046 1.327a4.816 4.816 0 0 0-1.932-1.746c-.81-.42-1.72-.624-2.709-.624-1.337 0-2.54.363-3.607 1.077a7.22 7.22 0 0 0-2.472 2.857c-.585 1.19-.877 2.493-.877 3.91 0 1.542.292 2.902.888 4.081.596 1.179 1.393 2.097 2.416 2.732 1.023.635 2.169.952 3.45.952 1.09 0 2.045-.193 2.866-.59a4.769 4.769 0 0 0 1.977-1.745l.045 1.292c0 .317.259.578.573.578h2.675c.315 0 .573-.26.573-.578V8.331a.583.583 0 0 0-.562-.578zm-4.281 10.395c-.73.793-1.652 1.19-2.776 1.19-1.124 0-2.056-.397-2.776-1.19-.73-.794-1.09-1.814-1.09-3.061 0-1.235.36-2.244 1.068-3.038.72-.793 1.64-1.179 2.787-1.179 1.146 0 2.079.397 2.787 1.18.719.793 1.067 1.802 1.067 3.037.023 1.258-.337 2.278-1.067 3.06zM48.153 22.92a12.28 12.28 0 0 1-3.147-.386c-.797-.204-1.45-.476-1.955-.782a.633.633 0 0 1-.28-.623l.291-1.95a.63.63 0 0 1 .91-.465c.461.238.956.442 1.506.612a8.379 8.379 0 0 0 2.506.408c1.619 0 2.439-.419 2.439-1.246 0-.442-.169-.783-.517-1.01-.348-.226-1.056-.498-2.146-.804-1.72-.476-2.945-1.088-3.675-1.836-.73-.737-1.101-1.735-1.101-2.993 0-1.405.528-2.516 1.573-3.321 1.045-.805 2.495-1.213 4.326-1.213.9 0 1.798.102 2.686.318.697.17 1.304.374 1.798.612a.617.617 0 0 1 .337.657l-.27 1.87a.623.623 0 0 1-.865.488 8.393 8.393 0 0 0-1.303-.442 8.726 8.726 0 0 0-2.214-.306c-1.394 0-2.09.374-2.09 1.122 0 .42.168.76.505.997.338.238 1 .51 1.99.794 1.831.544 3.124 1.179 3.876 1.904.753.737 1.135 1.746 1.135 3.027 0 1.428-.561 2.539-1.674 3.355-1.135.805-2.675 1.213-4.641 1.213zM56.289 27.828a.826.826 0 0 1 .652-.318c.157 0 .292.034.438.114.18.102.326.25.404.43.068.16.113.318.113.5 0 .34-.113.6-.326.804a.895.895 0 0 1-.64.25.775.775 0 0 1-.641-.318v.102a.328.328 0 0 1-.023.136c-.022.023-.056.023-.134.023h-.236c-.068 0-.113-.012-.124-.023-.022-.023-.022-.057-.022-.136v-3.095c0-.068.01-.113.022-.136.022-.022.056-.022.124-.022h.236a.32.32 0 0 1 .134.022c.023.023.023.057.023.136v1.53zm.483.181a.533.533 0 0 0-.382.159.516.516 0 0 0-.157.385.542.542 0 0 0 .54.544c.145 0 .28-.056.381-.158a.524.524 0 0 0 .158-.397.562.562 0 0 0-.158-.386.506.506 0 0 0-.382-.147zM58.862 29.245l-.809-1.474a.562.562 0 0 1-.045-.102c0-.034.011-.057.034-.068a.298.298 0 0 1 .124-.023h.292c.056 0 .1 0 .112.012a.423.423 0 0 1 .068.09l.528 1.02.505-1.008c.023-.057.045-.091.057-.091.01-.011.056-.011.112-.011h.28c.057 0 .09 0 .113.011.034.011.045.045.045.08 0 .022-.011.056-.045.101l-1.416 2.732c-.022.057-.045.08-.067.09-.011.012-.056.012-.112.012h-.281c-.057 0-.09 0-.113-.011-.033-.012-.045-.046-.045-.08 0-.022.012-.056.045-.102l.618-1.178z"}),d.a.createElement("path",{fillOpacity:.5,d:"M76.944 18.533c-.057-.113-.135-.227-.158-.351-.056-.295.191-.556.337-.794a11.732 11.732 0 0 0 1.135-2.494 11.92 11.92 0 0 0 .517-3.774c-.033-1.372-.28-2.743-.775-4.013A11.333 11.333 0 0 0 76.067 3.9a10.682 10.682 0 0 0-2.618-2.21 11.403 11.403 0 0 0-3.383-1.36A13.01 13.01 0 0 0 66.2.068c-1.314.102-2.618.42-3.82.963a11.504 11.504 0 0 0-3.237 2.21 11.196 11.196 0 0 0-2.292 3.209 11.64 11.64 0 0 0-1.057 3.831 12.794 12.794 0 0 0 .236 3.979c.281 1.27.787 2.493 1.484 3.593a10.734 10.734 0 0 0 2.55 2.788c.99.76 2.113 1.338 3.293 1.723.652.216 1.315.363 1.99.465.629.09 1.292.147 1.932.125a17.049 17.049 0 0 0 1.854-.16c.338-.056.675-.112 1-.203.282-.068.585-.125.697-.43.09-.25-.033-.454-.146-.67l-.404-.816-.742-1.496a.559.559 0 0 0-.326-.295c-.146-.045-.27-.011-.416.023a6.394 6.394 0 0 1-.494.09 7.722 7.722 0 0 1-2.045.012 7.49 7.49 0 0 1-3.551-1.485 7.525 7.525 0 0 1-2.338-3.026 7.554 7.554 0 0 1-.55-3.854 7.473 7.473 0 0 1 1.393-3.57 7.441 7.441 0 0 1 2.854-2.37 7.41 7.41 0 0 1 3.855-.691 7.407 7.407 0 0 1 3.36 1.156 7.647 7.647 0 0 1 2.281 2.3 7.725 7.725 0 0 1 1.169 3.64 7.514 7.514 0 0 1-.596 3.4 7.55 7.55 0 0 1-1.921 2.675c-.113.102-.236.193-.281.351a.54.54 0 0 0 .022.397l2.146 4.274c.113.215.214.544.439.68.157.09.36.068.528.068h3.281c.394-.012.674-.431.483-.794-.202-.397-.415-.793-.618-1.179l-1.27-2.448z"})),E=function(e){return d.a.createElement("svg",A({width:79,height:31,viewBox:"0 0 79 31"},e),y)};n.p;function w(){return(w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var O=d.a.createElement("path",{d:"M10.2 41.8c2 3.5 4.2 6.9 6.6 10.1H0v-3.5c3.3-2.3 6.7-4.5 10.2-6.6zM206.1 40.5c-4.6 3.4-8.8 7.2-12.6 11.4h-22.3c5.1-6.9 9.3-14.5 12.5-22.6 7.7 3.3 15.2 7 22.4 11.2z",fill:"#3394D2"}),k=d.a.createElement("path",{d:"M183.7 29.3c-3.2 8.1-7.4 15.7-12.5 22.6H16.7c-2.4-3.2-4.6-6.6-6.6-10.1C36.5 26 66.8 16.3 99.4 14.6a163.613 163.613 0 0 1 19.8 0c22.7 1.2 44.5 6.3 64.5 14.7z",fill:"#4ebbc2"}),j=d.a.createElement("path",{d:"M206.1 40.5c13-9.6 28.8-15.6 45.9-16.4v27.8h-28.6c-.3-.3-.7-.5-1-.8-.3-.2-.6-.5-.9-.7-.1 0-.1-.1-.2-.1-.3-.2-.6-.5-1-.7l-.9-.6c-.1-.1-.2-.2-.3-.2-.2-.2-.5-.3-.7-.5l-.9-.6c-.2-.1-.4-.3-.6-.4-.2-.2-.5-.3-.7-.5l-.9-.6-.9-.6s-.1-.1-.2-.1c-.4-.2-.7-.5-1.1-.7-.4-.2-.8-.5-1.1-.7s-.8-.5-1.2-.7c-.3-.2-.5-.3-.8-.5-1.4-.9-2.6-1.6-3.9-2.4z",fill:"#e53b5b"}),C=d.a.createElement("path",{d:"M223.4 51.9h-29.9c3.8-4.2 8-8 12.6-11.4 1.3.8 2.6 1.5 3.8 2.3.3.2.5.3.8.5.4.2.8.5 1.2.7s.8.5 1.1.7c.4.2.7.5 1.1.7.1 0 .1.1.2.1l.9.6.9.6c.3.2.5.3.7.5.2.1.4.3.6.4l.9.6c.2.2.5.3.7.5.1.1.2.2.3.2l.9.6c.3.2.7.5 1 .7.1 0 .1.1.2.1.3.2.6.5.9.7.4.4.7.6 1.1.9z",fill:"#6f559f"}),x=function(e){return d.a.createElement("svg",w({id:"Calque_1",preserveAspectRatio:"none",viewBox:"0 0 252 52"},e),O,k,j,C)};n.p;function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var N=d.a.createElement("defs",null,d.a.createElement("rect",{id:"a",width:120,height:120,rx:10}),d.a.createElement("path",{id:"b",d:"M78.667 60c0 1.4-.934 2.333-2.334 2.333h-14v14c0 1.4-.933 2.334-2.333 2.334-1.4 0-2.333-.934-2.333-2.334v-14h-14c-1.4 0-2.334-.933-2.334-2.333 0-1.4.934-2.333 2.334-2.333h14v-14c0-1.4.933-2.334 2.333-2.334 1.4 0 2.333.934 2.333 2.334v14h14c1.4 0 2.334.933 2.334 2.333z"})),_=d.a.createElement("g",{fill:"none",fillRule:"evenodd"},d.a.createElement("g",{opacity:.5},d.a.createElement("use",{fill:"#1F2330",xlinkHref:"#a"}),d.a.createElement("rect",{width:118,height:118,x:1,y:1,stroke:"#FFF",strokeWidth:2,rx:10})),d.a.createElement("use",{fill:"#FFF",fillRule:"nonzero",opacity:.5,xlinkHref:"#b"})),D=function(e){return d.a.createElement("svg",S({width:120,height:120,viewBox:"0 0 120 120"},e),N,_)};n.p;function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var P=d.a.createElement("polyline",{points:"6 9 12 15 18 9"}),L=function(e){return d.a.createElement("svg",R({width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-chevron-down"},e),P)},M=(n.p,n(11)),I=n(30),B=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={selectedUser:null,isWrongPassword:!1,isModalOpened:!1,isLoggedIn:!1,signup:!1,sync:!1,password:"",qrcodeModal:!1},n.handleClickSyncProfile=n.handleClickSyncProfile.bind(Object(p.a)(Object(p.a)(n))),n.handleClickNewProfile=n.handleClickNewProfile.bind(Object(p.a)(Object(p.a)(n))),n.handleClickNewUser=n.handleClickNewUser.bind(Object(p.a)(Object(p.a)(n))),n.onPasswordChange=n.onPasswordChange.bind(Object(p.a)(Object(p.a)(n))),n.closeQRCodeModal=n.closeQRCodeModal.bind(Object(p.a)(Object(p.a)(n))),n.openQRCodeModal=n.openQRCodeModal.bind(Object(p.a)(Object(p.a)(n))),n.onPasswordKeyUp=n.onPasswordKeyUp.bind(Object(p.a)(Object(p.a)(n))),n.handleSignup=n.handleSignup.bind(Object(p.a)(Object(p.a)(n))),n.handleClose=n.handleClose.bind(Object(p.a)(Object(p.a)(n))),n.connect=n.connect.bind(Object(p.a)(Object(p.a)(n))),n.goBack=n.goBack.bind(Object(p.a)(Object(p.a)(n))),n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchUsers()}},{key:"handleClickNewUser",value:function(){this.setState({isModalOpened:!this.state.isModalOpened})}},{key:"handleClose",value:function(){this.setState({isModalOpened:!1,signup:!1,sync:!1})}},{key:"handleSignup",value:function(e){(0,this.props.signup)(e),this.setState({isModalOpened:!1,signup:!1})}},{key:"handleClickNewProfile",value:function(){this.setState({isModalOpened:!1,signup:!0})}},{key:"handleClickSyncProfile",value:function(){this.setState({isModalOpened:!1,sync:!0})}},{key:"selectUser",value:function(e){this.setState({selectedUser:e})}},{key:"onPasswordChange",value:function(e){this.setState({password:e.target.value})}},{key:"onPasswordKeyUp",value:function(){var e=Object(c.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"Enter"===t.key&&this.connect();case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(c.a)(r.a.mark(function e(){var t,n,a,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.signin,n=this.state,a=n.password,c=n.selectedUser,e.prev=2,e.next=5,t(c,a);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),this.setState({isWrongPassword:!0});case 10:case"end":return e.stop()}},e,this,[[2,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"goBack",value:function(){this.setState({selectedUser:null})}},{key:"openQRCodeModal",value:function(){this.setState({qrcodeModal:!0})}},{key:"closeQRCodeModal",value:function(){this.setState({qrcodeModal:!1})}},{key:"renderUsersSelection",value:function(){var e=this,t=this.props,n=t.users,a=t.currentAppRequest,r=this.state,c=r.isModalOpened,s=r.signup,i=r.sync,o=r.qrcodeModal;return d.a.createElement("div",{style:{width:"100%"}},o&&d.a.createElement(I.c,{onClose:this.closeQRCodeModal}),d.a.createElement(E,{className:g.a.Logo}),d.a.createElement("h1",{className:g.a.title},"Qui est-ce ?"),a&&d.a.createElement("div",{style:{marginBottom:32}},d.a.createElement(v.Button,{label:"Se connecter avec un autre appareil",onClick:this.openQRCodeModal})),d.a.createElement("div",{className:g.a.users},n.map(function(t){return d.a.createElement("div",{key:t.username,className:g.a.user,onClick:function(){return e.selectUser(t)}},d.a.createElement(M.a,t),d.a.createElement("h2",null,t.username))}),d.a.createElement(D,{className:g.a.PlusSquare,onClick:this.handleClickNewUser})),s&&d.a.createElement(I.d,{onSignup:this.handleSignup,onClose:this.handleClose}),i&&d.a.createElement(I.e,{onClose:this.handleClose}),c&&d.a.createElement(I.a,{onClose:this.handleClose,onNewProfile:this.handleClickNewProfile,onSyncProfile:this.handleClickSyncProfile}))}},{key:"renderPassword",value:function(){var e=this.state.selectedUser;return d.a.createElement("div",{style:{width:"100%"}},d.a.createElement(E,{className:g.a.Logo}),d.a.createElement("div",{className:g.a.goback,onClick:this.goBack},d.a.createElement(L,{style:{transform:"rotate(90deg)",cursor:"pointer"}}),d.a.createElement("p",{style:{cursor:"pointer"}},"Changer d'utilisateur")),d.a.createElement("div",{className:g.a.users},d.a.createElement("div",{key:e.username,className:g.a.user},d.a.createElement(M.a,e),d.a.createElement("h2",null,e.username))),d.a.createElement("div",{className:g.a.passwordSection},d.a.createElement("p",null,"Entrez votre mot de passe"),d.a.createElement(v.TextField,{autoFocus:!0,type:"password",onChange:this.onPasswordChange,error:this.state.isWrongPassword,label:this.state.isWrongPassword?"Mauvais mot de passe, veuillez r\xe9essayer":"",onKeyUp:this.onPasswordKeyUp}),d.a.createElement("div",{style:{marginBottom:32}}),d.a.createElement(v.Button,{label:"connexion",onClick:this.connect})))}},{key:"componentDidUpdate",value:function(){this.props.user&&this.props.history.push("/apps")}},{key:"render",value:function(){var e=this.state.selectedUser;return d.a.createElement("div",{className:g.a.Login},e?this.renderPassword():this.renderUsersSelection(),d.a.createElement(x,{className:g.a.Background}))}}]),t}(h.Component),U=Object(f.b)(function(e){return{user:e.masq.currentUser,users:e.masq.users,currentAppRequest:e.masq.currentAppRequest}},function(e){return{signin:function(t,n){return e(Object(m.i)(t,n))},signup:function(t){return e(Object(m.k)(t))},fetchUsers:function(t){return e(Object(m.c)(t))}}})(B),z=n(125),V=n(75),T=n.n(V),q=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.user&&this.props.fetchApps()}},{key:"render",value:function(){var e=this.props,t=e.apps;return e.user?!!t&&d.a.createElement("div",{className:T.a.Apps},d.a.createElement("p",{className:"title"},"Mes Applications"),d.a.createElement("p",{className:"subtitle"},"Retrouvez vos applications synchronis\xe9es avec Masq"),t.map(function(e,t){return d.a.createElement("div",{key:t,className:T.a.Card},d.a.createElement(v.Card,{minHeight:64,title:e.name,image:e.imageURL,color:"#a3005c",description:e.description}))})):d.a.createElement(z.a,{to:"/"})}}]),t}(h.PureComponent),F=Object(f.b)(function(e){return{user:e.masq.currentUser,apps:e.masq.apps}},function(e){return{fetchApps:function(){return e(Object(m.b)())}}})(q),K=n(43),Y=n.n(K),G=n(242),Q=n(23),J=n.n(Q);function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var W=d.a.createElement("path",{d:"m37.2 0h-6.3c-.54 0-.9.36-.9.9v6.3c0 .54.36.9.9.9h6.3c.54 0 .9-.36.9-.9v-6.3c0-.54-.36-.9-.9-.9zm-.9 6.3h-4.5v-4.5h4.5zm10.8-6.3h-6.3c-.54 0-.9.36-.9.9v6.3c0 .54.36.9.9.9h6.3c.54 0 .9-.36.9-.9v-6.3c0-.54-.36-.9-.9-.9zm-.9 6.3h-4.5v-4.5h4.5zm.9 3.6h-6.3c-.54 0-.9.36-.9.9v6.3c0 .54.36.9.9.9h6.3c.54 0 .9-.36.9-.9v-6.3c0-.54-.36-.9-.9-.9zm-.9 6.3h-4.5v-4.5h4.5zm-9-6.3h-6.3c-.54 0-.9.36-.9.9v6.3c0 .54.36.9.9.9h6.3c.54 0 .9-.36.9-.9v-6.3c0-.54-.36-.9-.9-.9zm-.9 6.3h-4.5v-4.5h4.5z",transform:"translate(-30)"}),Z=function(e){return d.a.createElement("svg",H({height:18,viewBox:"0 0 18 18",width:18},e),W)};n.p;function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var $=d.a.createElement("path",{d:"m13 0h-10c-1.7 0-3 1.3-3 3v16c0 1.7 1.3 3 3 3h10c1.7 0 3-1.3 3-3v-16c0-1.7-1.3-3-3-3zm1 19c0 .6-.4 1-1 1h-10c-.6 0-1-.4-1-1v-16c0-.6.4-1 1-1h10c.6 0 1 .4 1 1zm-6-1c1.1045695 0 2-.8954305 2-2s-.8954305-2-2-2-2 .8954305-2 2 .8954305 2 2 2z",transform:""}),ee=function(e){return d.a.createElement("svg",X({height:22,viewBox:"0 0 16 22",width:16},e),$)};n.p;function te(){return(te=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var ne=d.a.createElement("path",{d:"m12 8c-2.2 0-4 1.8-4 4s1.8 4 4 4 4-1.8 4-4-1.8-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm8.3 1.4c.1-.2.3-.4.7-.4 1.7 0 3-1.3 3-3s-1.3-3-3-3h-.2c-.2 0-.4-.1-.5-.3 0-.1 0-.1-.1-.2-.1-.2-.1-.5.2-.8 1.2-1.2 1.2-3.1 0-4.2-.6-.6-1.3-.9-2.1-.9s-1.6.3-2.2.9c-.2.2-.5.2-.7.1-.2 0-.4-.3-.4-.6 0-1.7-1.3-3-3-3s-3 1.3-3 3v.2c0 .2-.1.4-.3.5-.1 0-.1 0-.2.1-.2.1-.5 0-.8-.2-1.2-1.2-3.1-1.2-4.2 0-1.2 1.2-1.2 3.1.1 4.3.2.2.2.5.1.8-.1.2-.4.4-.7.4-1.7 0-3 1.3-3 3s1.3 3 3 3h.2c.3 0 .5.2.6.4s.1.5-.2.8c-.6.6-.9 1.3-.9 2.1s.3 1.5.9 2.1c1.2 1.2 3.1 1.2 4.3-.1.2-.2.5-.2.8-.1s.4.3.4.7c0 1.7 1.3 3 3 3s3-1.3 3-3v-.2c0-.3.2-.5.4-.6s.5-.1.8.2c1.2 1.2 3.1 1.2 4.2 0 1.2-1.2 1.2-3.1-.1-4.3-.1-.2-.2-.5-.1-.7zm-1.8-.8c-.4 1-.2 2.1.6 3 .2.2.3.4.3.7s-.1.5-.3.7-.4.3-.7.3c-.3 0-.5-.1-.8-.4-.8-.8-1.9-1-2.9-.5-1 .4-1.6 1.4-1.6 2.4v.2c0 .6-.4 1-1 1s-1-.4-1-1v-.1c0-1.1-.7-2-1.7-2.4-.3-.2-.7-.2-1.1-.2-.7 0-1.4.3-1.9.8-.4.4-1 .4-1.4 0-.2-.2-.3-.4-.3-.7s.1-.5.4-.8c.8-.8 1-1.9.5-2.9-.4-1-1.4-1.6-2.4-1.6h-.2c-.6 0-1-.4-1-1s.4-1 1-1h.1c1.1 0 2-.7 2.4-1.7s.2-2.1-.6-3c-.4-.4-.4-1 0-1.4s1-.4 1.5.1c.7.7 1.8.9 2.7.6.1 0 .2 0 .3-.1 1-.4 1.6-1.4 1.6-2.4v-.2c0-.6.4-1 1-1s1 .4 1 1.1c0 1.1.6 2 1.6 2.4s2.1.2 3-.6c.2-.2.4-.3.7-.3s.5.1.7.3c.4.4.4 1-.1 1.5-.7.7-.9 1.8-.6 2.7 0 .1 0 .2.1.3.4 1 1.4 1.6 2.4 1.6h.2c.6 0 1 .4 1 1s-.4 1-1.1 1c-1 0-2 .6-2.4 1.6z",transform:""}),ae=function(e){return d.a.createElement("svg",te({height:24,viewBox:"0 0 24 24",width:24},e),ne)};n.p;function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var ce=d.a.createElement("path",{d:"m9.01126408 21c0 .6-.40050063 1-1.00125156 1h-5.00625783c-1.70212766 0-3.00375469-1.3-3.00375469-3v-16c0-1.7 1.30162703-3 3.00375469-3h5.00625783c.60075093 0 1.00125156.4 1.00125156 1s-.40050063 1-1.00125156 1h-5.00625783c-.60075094 0-1.00125156.4-1.00125156 1v16c0 .6.40050062 1 1.00125156 1h5.00625783c.60075093 0 1.00125156.4 1.00125156 1zm10.91364202-9.6c.1001252-.2.1001252-.5 0-.8-.1001251-.1-.1001251-.2-.2002503-.3l-4.0050062-4c-.4005007-.4-1.0012516-.4-1.4017522 0-.4005007.4-.4005007 1 0 1.4l2.3028786 2.3h-9.61201505c-.60075094 0-1.00125156.4-1.00125156 1s.40050062 1 1.00125156 1h9.61201505l-2.3028786 2.3c-.4005007.4-.4005007 1 0 1.4.2002503.2.5006258.3.7008761.3s.5006257-.1.7008761-.3l4.0050062-4c.1001252-.1.2002503-.2.2002503-.3z"}),se=function(e){return d.a.createElement("svg",re({height:22,viewBox:"0 0 20 22",width:20},e),ce)},ie=(n.p,function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.signout;return t?d.a.createElement("div",{className:J.a.Sidebar},d.a.createElement("div",null,d.a.createElement("div",{className:J.a.header},d.a.createElement(M.a,Object.assign({},t,{size:64})),d.a.createElement("h2",null,t.username)),d.a.createElement("div",{className:J.a.nav},d.a.createElement(G.a,{to:"/apps",className:J.a.navElement,activeClassName:J.a.active},d.a.createElement(Z,{fill:"white",opacity:.8,width:24}),d.a.createElement("p",{className:"label"})),d.a.createElement(G.a,{to:"/devices",className:J.a.navElement,activeClassName:J.a.active},d.a.createElement(ee,{fill:"white",opacity:.8,width:24}),d.a.createElement("p",{className:"label"})),d.a.createElement(G.a,{to:"/settings",className:J.a.navElement,activeClassName:J.a.active},d.a.createElement(ae,{fill:"white",opacity:.8,width:24}),d.a.createElement("p",{className:"label"})))),d.a.createElement("div",{className:J.a.logout,onClick:n},d.a.createElement("div",{className:J.a.navElement},d.a.createElement(se,{fill:"white",opacity:.8,width:24}),d.a.createElement("p",{className:"label"})))):d.a.createElement(z.a,{to:"/"})}}]),t}(d.a.Component)),oe=Object(f.b)(function(e){return{user:e.masq.currentUser}},function(e){return{signout:function(){return e(Object(m.j)())}}})(ie),ue=n(24),le=n.n(ue),pe=function(e){function t(){return Object(s.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.signout;return t?d.a.createElement("div",{className:le.a.Sidebar},d.a.createElement("div",{className:le.a.header},d.a.createElement(M.a,Object.assign({},t,{size:64})),d.a.createElement("h2",null,t.username)),d.a.createElement("div",{className:le.a.nav},d.a.createElement(G.a,{to:"/apps",className:le.a.navElement,activeClassName:le.a.active},d.a.createElement(Z,{fill:"white",opacity:.8,width:24}),d.a.createElement("p",{className:"label"},"Applications")),d.a.createElement(G.a,{to:"/devices",className:le.a.navElement,activeClassName:le.a.active},d.a.createElement(ee,{fill:"white",opacity:.8,width:24}),d.a.createElement("p",{className:"label"},"Appareils")),d.a.createElement(G.a,{to:"/settings",className:le.a.navElement,activeClassName:le.a.active},d.a.createElement(ae,{fill:"white",opacity:.8,width:24}),d.a.createElement("p",{className:"label"},"Param\xe8tres"))),d.a.createElement("div",{className:le.a.logout,onClick:n},d.a.createElement("div",{className:le.a.navElement},d.a.createElement(se,{fill:"white",opacity:.8,width:24}),d.a.createElement("p",{className:"label"},"D\xe9connexion")))):d.a.createElement(z.a,{to:"/"})}}]),t}(d.a.Component),he=Object(f.b)(function(e){return{user:e.masq.currentUser}},function(e){return{signout:function(){return e(Object(m.j)())}}})(pe),de=function(e){return d.a.createElement(h.Fragment,null,d.a.createElement(Y.a,{maxWidth:800},d.a.createElement(oe,e)),d.a.createElement(Y.a,{minWidth:801},d.a.createElement(he,e)))},fe=n(40),me=n(31),ve=n(21),be=n(44),ge=n.n(be),Ae=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={image:"",lastname:"",firstname:"",username:""},n.hasChanged=!1,n.validate=n.validate.bind(Object(p.a)(Object(p.a)(n))),n.isValid=n.isValid.bind(Object(p.a)(Object(p.a)(n))),n.handleKeyUp=n.handleKeyUp.bind(Object(p.a)(Object(p.a)(n))),n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.user;e&&this.setState({image:e.image,lastname:e.lastname,firstname:e.firstname,username:e.username})}},{key:"isValid",value:function(e){var t=this.props.user.id,n=this.state[e];switch(e){case"lastname":case"firstname":return Object(me.a)(n);case"username":return Object(me.c)(n)&&!Object(ve.c)(n,t);case"image":return!0;default:return!1}}},{key:"getUsernameLabel",value:function(){var e=this.state.username;return this.isValid("username")?arguments.length<=0?void 0:arguments[0]:Object(ve.c)(e)?arguments.length<=1?void 0:arguments[1]:arguments.length<=2?void 0:arguments[2]}},{key:"onChange",value:function(e,t){var n=t.target.value.trim();this.hasChanged=!0,this.setState(Object(fe.a)({},e,n))}},{key:"onImageChange",value:function(){var e=Object(c.a)(r.a.mark(function e(t){var n,a,c,s,i=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props.setNotification,a=new window.FileReader,c=t.target.files[0]){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,Object(ve.b)(c);case 7:if(!((s=e.sent).size>ve.a)){e.next=11;break}return n({title:"L'image s\xe9lectionn\xe9e est trop lourde. Veuillez en choisir une autre.",error:!0}),e.abrupt("return");case 11:a.addEventListener("load",function(){i.hasChanged=!0,i.setState({image:a.result})}),a.readAsDataURL(s);case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"validate",value:function(){var e=this;if(this.hasChanged){if(!Object.keys(this.state).every(function(t){return e.isValid(t)}))return this.forceUpdate();this.props.updateUser(this.props.user.id,this.state),this.hasChanged=!1}}},{key:"handleKeyUp",value:function(e){"Enter"===e.key&&this.validate()}},{key:"render",value:function(){var e=this;return this.props.user?d.a.createElement("div",{className:ge.a.Settings},d.a.createElement("div",{className:ge.a.main},d.a.createElement("p",{className:"title"},"Vos param\xe8tres d'utilisateur"),d.a.createElement("p",{className:"subtitle"},"Changez vos informations personnelles"),d.a.createElement("div",{className:ge.a.avatar},d.a.createElement(M.a,{upload:!0,size:192,image:this.state.image,onChange:function(t){return e.onImageChange(t)}}))),d.a.createElement("div",{className:ge.a.inputs},d.a.createElement(v.TextField,{error:!this.isValid("lastname"),onKeyUp:this.handleKeyUp,defaultValue:this.state.lastname,onChange:function(t){return e.onChange("lastname",t)},label:this.isValid("lastname")?"Nom":"Le nom ne peut \xeatre vide, et ne peut contenir que des caract\xe8res alphanum\xe9riques et des espaces."}),d.a.createElement(v.TextField,{error:!this.isValid("firstname"),onKeyUp:this.handleKeyUp,defaultValue:this.state.firstname,onChange:function(t){return e.onChange("firstname",t)},label:this.isValid("firstname")?"Pr\xe9nom":"Le pr\xe9nom ne peut \xeatre vide, et ne peut contenir que des caract\xe8res alphanum\xe9riques et des espaces."}),d.a.createElement(v.TextField,{error:!this.isValid("username"),onKeyUp:this.handleKeyUp,defaultValue:this.state.username,onChange:function(t){return e.onChange("username",t)},label:this.getUsernameLabel("Pseudo (affich\xe9)","Pseudo d\xe9j\xe0 utilis\xe9. Veuillez en choisir un autre.","Le pseudo ne doit pas contenir d'espaces, et peut contenir les caract\xe8res sp\xe9ciaux suivants: !?$#@()-*")})),d.a.createElement("div",{className:ge.a.sidebar},d.a.createElement(v.Button,{width:200,secondary:!this.hasChanged,label:"SAUVEGARDER",onClick:this.validate}))):d.a.createElement(z.a,{to:"/"})}}]),t}(d.a.Component),ye=Object(f.b)(function(e){return{user:e.masq.currentUser}},function(e){return{updateUser:function(t,n){return e(Object(m.l)(t,n))},setNotification:function(t){return e(Object(m.g)(t))}}})(Ae),Ee=n(53),we=n.n(Ee),Oe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={addDevice:!1},n.handleAddDeviceClick=n.handleAddDeviceClick.bind(Object(p.a)(Object(p.a)(n))),n.renderSyncModal=n.renderSyncModal.bind(Object(p.a)(Object(p.a)(n))),n.handleSyncModalClosed=n.handleSyncModalClosed.bind(Object(p.a)(Object(p.a)(n))),n}return Object(l.a)(t,e),Object(i.a)(t,[{key:"handleAddDeviceClick",value:function(){this.setState({addDevice:!0})}},{key:"handleSyncModalClosed",value:function(){this.setState({addDevice:!1})}},{key:"renderSyncModal",value:function(){return!!this.state.addDevice&&d.a.createElement(I.e,{onClose:this.handleSyncModalClosed})}},{key:"render",value:function(){var e=this.props,t=e.user,n=e.devices;return t?d.a.createElement("div",{className:we.a.Devices},d.a.createElement("div",{className:we.a.main},this.renderSyncModal(),d.a.createElement("p",{className:"title"},"Mes Appareils"),d.a.createElement("p",{className:"subtitle"},"Retrouvez la liste de vos appareils connect\xe9s \xe0 Masq"),n.map(function(e,t){return d.a.createElement("div",{key:t,className:we.a.Card},d.a.createElement(v.Card,{minHeight:64,title:e.name,color:e.color,description:e.description}))})),d.a.createElement("div",{className:we.a.sidebar},d.a.createElement(v.Button,{secondary:!0,label:"Ajouter un appareil (bient\xf4t)"}))):d.a.createElement(z.a,{to:"/"})}}]),t}(d.a.Component),ke=Object(f.b)(function(e){return{user:e.masq.currentUser,devices:e.masq.devices}})(Oe);n.d(t,"c",function(){return U}),n.d(t,"a",function(){return F}),n.d(t,"e",function(){return de}),n.d(t,"d",function(){return ye}),n.d(t,"b",function(){return ke})},44:function(e,t,n){e.exports={Settings:"Settings_Settings__28zgm",titleContainer:"Settings_titleContainer__21xuE",inputs:"Settings_inputs__3ibhs",fields:"Settings_fields__bgECp",TextInput:"Settings_TextInput__3I5OA","button-container":"Settings_button-container__O8Z8B",parameters:"Settings_parameters__2JumS",sidebar:"Settings_sidebar__30WIY",appSettings:"Settings_appSettings__bdows",buttons:"Settings_buttons__3g-6r",exportButton:"Settings_exportButton__320ym",avatar:"Settings_avatar__3d9Ia"}},53:function(e,t,n){e.exports={Devices:"Devices_Devices__3FpT6",main:"Devices_main__CB0P2",Card:"Devices_Card__dkNc-",sidebar:"Devices_sidebar__2ux5H"}},62:function(e,t,n){e.exports={QRCode:"QRCodeModal_QRCode__3ot3Q",title:"QRCodeModal_title__14tJW",description:"QRCodeModal_description__A1fo3",loader:"QRCodeModal_loader__3p9zs"}},74:function(e,t,n){e.exports={PermanentStorage:"PermanentStorageRequest_PermanentStorage__iYc7A",title:"PermanentStorageRequest_title__3GWxr"}},75:function(e,t,n){e.exports={Apps:"Apps_Apps__sNPwb",Card:"Apps_Card__3sq9A"}},78:function(e,t,n){"use strict";(function(e){var a=n(52),r=n(19),c=n(1),s=n.n(c),i=n(4),o=n(8),u=n(9),l=n(71),p=n.n(l),h=n(72),d=n.n(h),f=n(116),m=n.n(f),v=n(73),b=n.n(v),g=n(61),A=n(21),y=g.a,E=y.encrypt,w=y.decrypt,O=y.importKey,k=y.exportKey,j=y.genAESKey,C=y.genEncryptedMasterKey,x=y.decryptMasterKey,S=g.c,N=S.dbReady,_=S.createPromisifiedHyperDB,D=S.put,R=S.get,P=g.b,L=P.ERRORS,M=P.MasqError,I=P.checkObject,B="wss://signalhub-jvunerwwrg.now.sh".split(","),U={},z=["name"],V=["name","description","appId"],T=["username","firstname","lastname","password","image"],q=function(e){return _(e)},F=function(){function t(){Object(o.a)(this,t),this.profileId=null,this.profileDB=null,this.appsDBs={},this.swarms={},this.hubs={},this.sw=null,this.hub=null,this.key=null,this.masterKey=null,this.peer=null,this.app=null}return Object(u.a)(t,[{key:"openProfile",value:function(){var e=Object(i.a)(s.a.mark(function e(t,n){var a,r,c,i=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new M(L.MISSING_PROFILE_ID);case 2:return this.closeProfile(),this.profileId=t,this.profileDB=q(t),e.next=7,this._getProtectedMK();case 7:return a=e.sent,e.prev=8,e.next=11,x(n,a);case 11:return r=e.sent,e.next=14,O(r);case 14:this.masterKey=e.sent,e.next=21;break;case 17:throw e.prev=17,e.t0=e.catch(8),this.closeProfile(),new M(L.INVALID_PASSPHRASE);case 21:return e.next=23,N(this.profileDB);case 23:return this._startReplicate(this.profileDB),e.next=26,this.getApps();case 26:return e.sent.forEach(function(e){var n=t+"-"+e.id,a=q(n);i.appsDBs[n]=a,a.on("ready",function(){return i._startReplicate(a)})}),e.next=30,this.getAndDecrypt("/profile");case 30:return c=e.sent,e.abrupt("return",c);case 32:case"end":return e.stop()}},e,this,[[8,17]])}));return function(t,n){return e.apply(this,arguments)}}()},{key:"closeProfile",value:function(){var e=Object(i.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._stopAllReplicates(),this.profileDB=null,this.masterKey=null,this.profileId=null,this.appsDBs={};case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addProfile",value:function(){var e=Object(i.a)(s.a.mark(function e(t){var n,a,c,i,o,u;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return I(t,T),e.next=3,Object(A.c)(t.username);case 3:if(!e.sent){e.next=6;break}throw new M(L.USERNAME_ALREADY_TAKEN);case 6:return n=b()(),e.next=9,C(t.password);case 9:return a=e.sent,e.next=12,x(t.password,a);case 12:return c=e.sent,e.next=15,O(c);case 15:return this.masterKey=e.sent,i={username:t.username,image:t.image,id:n},o=Object(r.a)({},i,{firstname:t.firstname,lastname:t.lastname}),u=q(n),e.next=21,N(u);case 21:return e.next=23,u.putAsync("/profile/protectedMK",a);case 23:return e.next=25,D(u,this.masterKey,"/profile",o);case 25:return this._setProfileToLocalStorage(i),e.abrupt("return",o);case 27:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAndDecrypt",value:function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkProfile(),this._checkMK(),e.next=4,R(this.profileDB,this.masterKey,t);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"encryptAndPut",value:function(){var e=Object(i.a)(s.a.mark(function e(t,n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkProfile(),this._checkMK(),e.next=4,D(this.profileDB,this.masterKey,t,n);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getProfiles",value:function(){var e=Object(i.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._getProfilesFromLocalStorage());case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getProfile",value:function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAndDecrypt("/profile");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateProfile",value:function(){var e=Object(i.a)(s.a.mark(function e(t){var n,a,c,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._checkProfile(),n=t.id){e.next=4;break}throw new M(L.MISSING_PROFILE_ID);case 4:return e.next=6,Object(A.c)(t.username,n);case 6:if(!e.sent){e.next=9;break}throw new M(L.USERNAME_ALREADY_TAKEN);case 9:return e.next=11,this.getProfile(n);case 11:return a=e.sent,c=Object(r.a)({},a,t),i={username:c.username,image:c.image,id:n},e.next=16,this.encryptAndPut("/profile",c);case 16:this._setProfileToLocalStorage(i);case 17:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"addApp",value:function(e){return I(e,V),this._createResource("apps",e)}},{key:"addDevice",value:function(e){return I(e,z),this._createResource("devices",e)}},{key:"getApps",value:function(){return this._checkProfile(),this._getResources("apps")}},{key:"getDevices",value:function(){return this._checkProfile(),this._getResources("devices")}},{key:"updateApp",value:function(){var e=Object(i.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkProfile(),e.next=3,this._updateResource("apps",t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateDevice",value:function(){var e=Object(i.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkProfile(),e.next=3,this._updateResource("devices",t);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleUserAppLogin",value:function(){var t=Object(i.a)(s.a.mark(function t(n,a,r){var c=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=Object(i.a)(s.a.mark(function t(o,u){var l,h;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return c.appId=r,c._checkProfile(),t.next=4,O(e.from(a,"base64"));case 4:c.key=t.sent,l=function(){var e=Object(i.a)(s.a.mark(function e(t,n,a,r,i){var o,u;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o={msg:"authorized",userAppDbId:n,userAppDEK:a,username:r,profileImage:i},e.next=3,E(c.key,o,"base64");case 3:u=e.sent,t.send(JSON.stringify(u));case 5:case"end":return e.stop()}},e)}));return function(t,n,a,r,c){return e.apply(this,arguments)}}(),h=function(){var e=Object(i.a)(s.a.mark(function e(t){var n,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={msg:"notAuthorized"},e.next=3,E(c.key,n,"base64");case 3:a=e.sent,t.send(JSON.stringify(a));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),c.hub=p()(n,B),c.sw=d()(c.hub,U),c.sw.on("disconnect",Object(i.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c._closeUserAppConnection();case 2:return e.abrupt("return",u(new M(L.DISCONNECTED_DURING_LOGIN)));case 3:case"end":return e.stop()}},e)}))),c.sw.once("peer",function(){var e=Object(i.a)(s.a.mark(function e(t){var n,a,p;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c.peer=t,t.on("error",function(){var e=Object(i.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c._closeUserAppConnection();case 2:return e.abrupt("return",u(t));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=4,c.getApps();case 4:if(n=e.sent,a=n.find(function(e){return e.appId===r}),e.prev=6,!a){e.next=15;break}return e.next=10,c.getProfile(c.profileId);case 10:return p=e.sent,e.next=13,l(t,a.id,a.appDEK,p.username,p.image);case 13:e.next=17;break;case 15:return e.next=17,h(t);case 17:e.next=24;break;case 19:return e.prev=19,e.t0=e.catch(6),e.next=23,c._closeUserAppConnection();case 23:return e.abrupt("return",u(new M(L.DISCONNECTED_DURING_LOGIN)));case 24:t.once("data",function(){var e=Object(i.a)(s.a.mark(function e(t){var n,a,r,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(c.key,JSON.parse(t),"base64");case 2:if("connectionEstablished"!==(n=e.sent).msg){e.next=9;break}return e.next=6,c._closeUserAppConnection();case 6:return e.abrupt("return",o(!0));case 9:if("registerUserApp"!==n.msg){e.next=15;break}a=n.name,r=n.description,i=n.imageURL,c.app={name:a,description:r,imageURL:i},o(!1),e.next=18;break;case 15:return e.next=17,c._closeUserAppConnection();case 17:u(new M(L.INVALID_DATA));case 18:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}());case 25:case"end":return e.stop()}},e,null,[[6,19]])}));return function(t){return e.apply(this,arguments)}}());case 11:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t)}));return function(e,n,a){return t.apply(this,arguments)}}()},{key:"handleUserAppRegister",value:function(){var t=Object(i.a)(s.a.mark(function t(n){var a=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=Object(i.a)(s.a.mark(function t(c,o){var u,l,p,h,d,f,m,v,b,g,A;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a._checkProfile(),u="",l=function(){var e=Object(i.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={msg:"masqAccessRefused"},e.next=3,E(a.key,n,"base64");case 3:r=e.sent,t.send(JSON.stringify(r));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(i.a)(s.a.mark(function e(t,n,r,c,i,o){var u,l;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u={msg:"masqAccessGranted",key:n,userAppDbId:r,userAppDEK:c,username:i,profileImage:o},e.next=3,E(a.key,u,"base64");case 3:l=e.sent,t.send(JSON.stringify(l));case 5:case"end":return e.stop()}},e)}));return function(t,n,a,r,c,s){return e.apply(this,arguments)}}(),h=function(){var e=Object(i.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={msg:"writeAccessGranted"},e.next=3,E(a.key,n,"base64");case 3:r=e.sent,t.send(JSON.stringify(r));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),d=function(){var t=Object(i.a)(s.a.mark(function t(n,r){var i,o;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(a.key,JSON.parse(r),"base64");case 2:if(i=t.sent,"requestWriteAccess"!==i.msg){t.next=18;break}return o=e.from(i.key,"hex"),t.prev=6,t.next=9,a.appsDBs[u].authorizeAsync(o);case 9:t.next=14;break;case 11:throw t.prev=11,t.t0=t.catch(6),new M(L.AUTHORIZE_DB_KEY_FAILED);case 14:return t.next=16,h(n);case 16:return a.sw.close(),t.abrupt("return",c());case 18:case"end":return t.stop()}},t,null,[[6,11]])}));return function(e,n){return t.apply(this,arguments)}}(),n){t.next=12;break}return t.next=9,l(a.peer);case 9:return t.next=11,a._closeUserAppConnection();case 11:return t.abrupt("return",c());case 12:return t.next=14,a.getApps();case 14:if(f=t.sent,!(m=f.find(function(e){return e.appId===a.appId}))){t.next=20;break}t.t0=m.appDEK,t.next=23;break;case 20:return t.next=22,a._genAppDEK();case 22:t.t0=t.sent;case 23:if(v=t.t0,!m){t.next=28;break}t.t1=m.id,t.next=31;break;case 28:return t.next=30,a.addApp(Object(r.a)({},a.app,{appId:a.appId,appDEK:v}));case 30:t.t1=t.sent;case 31:return b=t.t1,t.next=34,a.getProfile(a.profileId);case 34:g=t.sent,u=a.profileId+"-"+b,A=q(u),a.appsDBs[u]=A,A.on("ready",Object(i.a)(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a._startReplicate(A),e.next=3,p(a.peer,A.key.toString("hex"),b,v,g.username,g.image);case 3:case"end":return e.stop()}},e)}))),a.peer.on("data",function(e){return d(a.peer,e)});case 40:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},{key:"_genAppDEK",value:function(){var t=Object(i.a)(s.a.mark(function t(){var n,a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,j(!0,"AES-GCM",128);case 2:return n=t.sent,t.next=5,k(n);case 5:return a=t.sent,r=e.from(a).toString("hex"),t.abrupt("return",r);case 8:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()},{key:"_decryptValue",value:function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(this.masterKey,t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_encryptValue",value:function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(this.masterKey,t);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_getProtectedMK",value:function(){var e=Object(i.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkProfile(),e.next=3,this.profileDB.getAsync("/profile/protectedMK");case 3:return t=e.sent,e.abrupt("return",t.value);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"_createResource",value:function(){var e=Object(i.a)(s.a.mark(function e(t,n){var r,c,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAndDecrypt("/".concat(t));case 2:return r=e.sent,c=r||[],i=b()(),n.id=i,e.next=8,this.encryptAndPut("/".concat(t),[].concat(Object(a.a)(c),[i]));case 8:return e.next=10,this.encryptAndPut("/".concat(t,"/").concat(i),n);case 10:return e.abrupt("return",i);case 11:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getResources",value:function(){var e=Object(i.a)(s.a.mark(function e(t){var n,a,r,c=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAndDecrypt("/".concat(t));case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:return a=n.map(function(){var e=Object(i.a)(s.a.mark(function e(n){var a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.getAndDecrypt("/".concat(t,"/").concat(n));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),e.next=9,Promise.all(a);case 9:return r=e.sent,e.abrupt("return",r);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_updateResource",value:function(e,t){var n=t.id;if(!n)throw new M(L.MISSING_RESOURCE_ID);return this.encryptAndPut("/".concat(e,"/").concat(n),t)}},{key:"_setProfileToLocalStorage",value:function(e){var t=e.id;if(!t)throw new M(L.MISSING_PROFILE_ID);window.localStorage.setItem(t,JSON.stringify({id:t,username:e.username,image:e.image}))}},{key:"_getProfilesFromLocalStorage",value:function(){var e=Object.keys(window.localStorage);return e?e.map(function(e){return JSON.parse(window.localStorage.getItem(e))}):[]}},{key:"_startReplicate",value:function(e){var t=e.discoveryKey.toString("hex");this.hubs[t]=p()(t,B),this.swarms[t]=d()(this.hubs[t],U),this.swarms[t].on("peer",function(t){var n=e.replicate({live:!0});m()(t,n,t)})}},{key:"_stopAllReplicates",value:function(){Object.values(this.swarms).forEach(function(e){return e.close()}),this.swarms={},this.hubs={}}},{key:"_checkProfile",value:function(){if(!this.profileDB)throw new M(L.PROFILE_NOT_OPENED)}},{key:"_checkMK",value:function(){if(!this.masterKey)throw Error("MasterKey is not set")}},{key:"_closeUserAppConnection",value:function(){var e=this;return new Promise(function(t,n){e.sw.on("close",function(){return e.hub=null,e.peer=null,e.app=null,t()}),e.sw.close()})}}]),t}();t.a=F}).call(this,n(6).Buffer)}},[[126,1,2]]]);
//# sourceMappingURL=main.e10be9ac.chunk.js.map